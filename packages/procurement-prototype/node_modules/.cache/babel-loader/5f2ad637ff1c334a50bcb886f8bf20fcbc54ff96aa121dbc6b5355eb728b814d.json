{"ast":null,"code":"import _objectSpread from\"C:/Users/yacov.gorovoy/Documents/Cursor-workspace/procurement-prototype/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import Sidebar from'../components/Sidebar';import Header from'../components/Header';import Button from'../components/Button';import BackLink from'../components/BackLink';import Stepper from'../components/Stepper';import FormInput from'../components/FormInput';import FormSelect from'../components/FormSelect';import FormTextarea from'../components/FormTextarea';import LineItemsTable from'../components/LineItemsTable';import Badge from'../components/Badge';import SystemMessage from'../components/SystemMessage';import{SUPPLIERS,PURCHASE_TYPES,SUBSIDIARIES,saveDraft,getDraft,generateDraftId,saveCurrentDraft,clearCurrentDraft,SAMPLE_HOME_REQUESTS}from'../utils/mockData';import{localDB}from'../utils/localDB';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function RequestForm(_ref){var _steps$currentStep;let{onNavigate,draftId,aiData}=_ref;const[sidebarExpanded,setSidebarExpanded]=useState(true);const[currentStep,setCurrentStep]=useState(0);const[formData,setFormData]=useState({id:draftId||generateDraftId(),title:'',supplier:'',purchaseType:'',subsidiary:'',description:'',lineItems:[{currency:'USD',amount:'',quantity:'1',desc:''}],supplierInfo:{companyName:'',contactName:'',email:'',phone:'',address:'',taxId:''},security:{riskLevel:'',complianceRequired:false,securityNotes:''}});const[errors,setErrors]=useState({});const[isNewVendor,setIsNewVendor]=useState(false);const[newVendorName,setNewVendorName]=useState('');const[showAIFilling,setShowAIFilling]=useState(!!aiData);const[showAISuccess,setShowAISuccess]=useState(false);useEffect(()=>{// Load existing draft if draftId provided\nif(draftId){const existingDraft=localDB.getById(draftId);if(existingDraft){// Synthesize lineItems if missing\nlet lineItems=existingDraft.lineItems;if(!lineItems){let amt=0;if(existingDraft.amount){const match=String(existingDraft.amount).match(/([\\d,.]+)/);amt=match?parseFloat(match[1].replace(/,/g,'')):0;}lineItems=[{currency:'USD',amount:amt,quantity:'1',desc:'demo'}];}setFormData(_objectSpread(_objectSpread({},existingDraft),{},{lineItems}));setIsNewVendor(existingDraft.supplier==='new_vendor');if(existingDraft.supplier==='new_vendor'){var _existingDraft$suppli,_existingDraft$suppli2;// Set newVendorName from vendor field if present\nsetNewVendorName(existingDraft.vendor||((_existingDraft$suppli=existingDraft.supplierInfo)===null||_existingDraft$suppli===void 0?void 0:_existingDraft$suppli.companyName)||'');// Ensure supplierInfo.companyName is set\nif(!((_existingDraft$suppli2=existingDraft.supplierInfo)!==null&&_existingDraft$suppli2!==void 0&&_existingDraft$suppli2.companyName)&&existingDraft.vendor){setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{supplierInfo:_objectSpread(_objectSpread({},prev.supplierInfo),{},{companyName:existingDraft.vendor})}));}}}}// Load AI data if provided\nif(aiData){setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{title:aiData.title||'',supplier:aiData.supplier||'',purchaseType:aiData.purchaseType||'',subsidiary:aiData.subsidiary||'',description:aiData.description||'',lineItems:aiData.lineItems||[{currency:'USD',amount:'',quantity:'1',desc:''}]}));setIsNewVendor(aiData.supplier==='new_vendor');}},[draftId,aiData]);useEffect(()=>{// Save current draft to session storage\nsaveCurrentDraft(formData);},[formData]);useEffect(()=>{if(aiData){setShowAIFilling(true);setShowAISuccess(false);const timer=setTimeout(()=>{setShowAIFilling(false);setShowAISuccess(true);},2000);return()=>clearTimeout(timer);}else{setShowAIFilling(false);setShowAISuccess(false);}},[aiData]);const steps=[{label:'Purchase details',active:currentStep===0,completed:currentStep>0},{label:'Supplier info',active:currentStep===1,completed:currentStep>1,required:isNewVendor},{label:'Security',active:currentStep===2,completed:currentStep>2,required:isNewVendor},{label:'Review & Submit',active:currentStep===3,completed:false}].filter(step=>!step.required||step.required===isNewVendor);const validateCurrentStep=()=>{const newErrors={};if(currentStep===0){if(!formData.title.trim())newErrors.title='Title is required';if(!formData.supplier)newErrors.supplier='Supplier is required';if(!formData.purchaseType)newErrors.purchaseType='Purchase type is required';if(!formData.subsidiary)newErrors.subsidiary='Subsidiary is required';if(!formData.description.trim())newErrors.description='Description is required';// Validate line items\nconst lineItemErrors=formData.lineItems.map(item=>{const itemErrors={};if(!item.amount||parseFloat(item.amount)<=0)itemErrors.amount='Valid amount is required';if(!item.desc.trim())itemErrors.desc='Description is required';return itemErrors;});if(lineItemErrors.some(errors=>Object.keys(errors).length>0)){newErrors.lineItems=lineItemErrors;}}if(currentStep===1&&isNewVendor){if(!formData.supplierInfo.companyName.trim())newErrors.companyName='Company name is required';if(!formData.supplierInfo.contactName.trim())newErrors.contactName='Contact name is required';if(!formData.supplierInfo.email.trim())newErrors.email='Email is required';}if(currentStep===2&&isNewVendor){if(!formData.security.riskLevel)newErrors.riskLevel='Risk level is required';}setErrors(newErrors);return Object.keys(newErrors).length===0;};const handleNext=()=>{// Sync newVendorName to formData.supplierInfo.companyName if needed\nif(formData.supplier==='new_vendor'&&newVendorName&&!formData.supplierInfo.companyName){setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{supplierInfo:_objectSpread(_objectSpread({},prev.supplierInfo),{},{companyName:newVendorName})}));}if(validateCurrentStep()){if(currentStep<steps.length-1){setCurrentStep(currentStep+1);}else{handleSubmit();}}};const handleBack=()=>{if(currentStep>0){setCurrentStep(currentStep-1);}else{onNavigate('home');}};const handleSaveDraft=()=>{// Determine vendor name\nlet vendor='';if(formData.supplier==='new_vendor'){vendor=formData.supplierInfo.companyName||'New Vendor';}else{const supplierObj=SUPPLIERS.find(s=>s.value===formData.supplier);vendor=supplierObj?supplierObj.label:formData.supplier;}const isNewVendorFlag=formData.supplier==='new_vendor';// Save draft with vendor and isNewVendor fields\nconst updatedDraft=_objectSpread(_objectSpread({},formData),{},{vendor,isNewVendor:isNewVendorFlag});// Update in localDB\nlocalDB.update(formData.id,updatedDraft);onNavigate('home');};const handleSubmit=()=>{if(validateCurrentStep()){// Save as submitted request (in real app, this would go to backend)\nconst updatedDraft=_objectSpread(_objectSpread({},formData),{},{status:'Pending approval',updatedAt:new Date().toISOString()});localDB.update(formData.id,updatedDraft);onNavigate('home');}};const handleSupplierChange=value=>{setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{supplier:value}));setIsNewVendor(value==='new_vendor');if(value!=='new_vendor')setNewVendorName('');};const handleLineItemsChange=items=>{setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{lineItems:items}));};// Merge all vendors from SUPPLIERS, SAMPLE_HOME_REQUESTS, and all requests in localDB\nconst allVendorsSet=new Set([...SUPPLIERS.map(s=>s.label),...SAMPLE_HOME_REQUESTS.map(r=>r.vendor),...localDB.getAll().map(r=>r.vendor)]);const allVendors=Array.from(allVendorsSet).filter(Boolean);const vendorOptions=allVendors.map(vendor=>{const supplier=SUPPLIERS.find(s=>s.label===vendor);return supplier?{value:supplier.value,label:supplier.label}:{value:vendor,label:vendor};});vendorOptions.push({value:'new_vendor',label:'Add new vendor...'});// Sort vendor options alphabetically (except 'Add new vendor...' stays last)\nconst sortedVendorOptions=vendorOptions.slice(0,-1).sort((a,b)=>a.label.localeCompare(b.label));sortedVendorOptions.push(vendorOptions[vendorOptions.length-1]);const renderStepContent=()=>{switch(currentStep){case 0:return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsx(FormInput,{label:\"Request Title\",value:formData.title,onChange:e=>setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{title:e.target.value})),placeholder:\"e.g., Zoom Premium Licenses for Sales Team\",required:true,className:errors.title?'border-red-500':''}),errors.title&&/*#__PURE__*/_jsx(\"p\",{className:\"text-red-500 text-sm\",children:errors.title}),/*#__PURE__*/_jsx(FormSelect,{label:\"Supplier\",value:(()=>{// Try to match supplier value, otherwise match by vendor label\nif(formData.supplier)return formData.supplier;const found=sortedVendorOptions.find(opt=>opt.label===formData.vendor);return found?found.value:'';})(),onChange:handleSupplierChange,options:sortedVendorOptions,placeholder:\"Select supplier\",required:true,searchPlaceholder:\"Search suppliers...\",action:{label:'Add new vendor',onClick:()=>handleSupplierChange('new_vendor')},onActionWithSearch:search=>{setNewVendorName(search);setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{supplier:'new_vendor'}));setIsNewVendor(true);},selectedDisplay:formData.supplier==='new_vendor'&&newVendorName?/*#__PURE__*/_jsxs(\"span\",{className:\"flex items-center gap-2\",children:[newVendorName,/*#__PURE__*/_jsx(Badge,{text:\"New vendor\",color:\"bg-green-100 text-green-800\"})]}):undefined}),errors.supplier&&/*#__PURE__*/_jsx(\"p\",{className:\"text-red-500 text-sm\",children:errors.supplier}),/*#__PURE__*/_jsx(FormSelect,{label:\"Purchase Type\",value:formData.purchaseType,onChange:value=>setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{purchaseType:value})),options:[...PURCHASE_TYPES].sort((a,b)=>a.label.localeCompare(b.label)),placeholder:\"Select purchase type\",required:true}),errors.purchaseType&&/*#__PURE__*/_jsx(\"p\",{className:\"text-red-500 text-sm\",children:errors.purchaseType}),/*#__PURE__*/_jsx(FormSelect,{label:\"Subsidiary\",value:formData.subsidiary,onChange:value=>setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{subsidiary:value})),options:[...SUBSIDIARIES].sort((a,b)=>a.label.localeCompare(b.label)),placeholder:\"Select subsidiary\",required:true}),errors.subsidiary&&/*#__PURE__*/_jsx(\"p\",{className:\"text-red-500 text-sm\",children:errors.subsidiary}),/*#__PURE__*/_jsx(FormTextarea,{label:\"Description\",value:formData.description,onChange:e=>setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{description:e.target.value})),placeholder:\"Describe the purpose and details of this purchase request\",required:true}),errors.description&&/*#__PURE__*/_jsx(\"p\",{className:\"text-red-500 text-sm\",children:errors.description}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block mb-2 font-medium text-gray-600\",children:\"Line Items\"}),/*#__PURE__*/_jsx(LineItemsTable,{items:formData.lineItems,onItemChange:handleLineItemsChange,maxItems:20})]})]});case 1:if(!isNewVendor)return null;return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsx(FormInput,{label:\"Company Name\",value:formData.supplierInfo.companyName,onChange:e=>setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{supplierInfo:_objectSpread(_objectSpread({},prev.supplierInfo),{},{companyName:e.target.value})})),placeholder:\"Enter company name\",required:true}),errors.companyName&&/*#__PURE__*/_jsx(\"p\",{className:\"text-red-500 text-sm\",children:errors.companyName}),/*#__PURE__*/_jsx(FormInput,{label:\"Contact Name\",value:formData.supplierInfo.contactName,onChange:e=>setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{supplierInfo:_objectSpread(_objectSpread({},prev.supplierInfo),{},{contactName:e.target.value})})),placeholder:\"Enter contact person name\",required:true}),errors.contactName&&/*#__PURE__*/_jsx(\"p\",{className:\"text-red-500 text-sm\",children:errors.contactName}),/*#__PURE__*/_jsx(FormInput,{label:\"Email\",type:\"email\",value:formData.supplierInfo.email,onChange:e=>setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{supplierInfo:_objectSpread(_objectSpread({},prev.supplierInfo),{},{email:e.target.value})})),placeholder:\"Enter contact email\",required:true}),errors.email&&/*#__PURE__*/_jsx(\"p\",{className:\"text-red-500 text-sm\",children:errors.email}),/*#__PURE__*/_jsx(FormInput,{label:\"Phone\",value:formData.supplierInfo.phone,onChange:e=>setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{supplierInfo:_objectSpread(_objectSpread({},prev.supplierInfo),{},{phone:e.target.value})})),placeholder:\"Enter contact phone\"}),/*#__PURE__*/_jsx(FormTextarea,{label:\"Address\",value:formData.supplierInfo.address,onChange:e=>setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{supplierInfo:_objectSpread(_objectSpread({},prev.supplierInfo),{},{address:e.target.value})})),placeholder:\"Enter company address\"}),/*#__PURE__*/_jsx(FormInput,{label:\"Tax ID\",value:formData.supplierInfo.taxId,onChange:e=>setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{supplierInfo:_objectSpread(_objectSpread({},prev.supplierInfo),{},{taxId:e.target.value})})),placeholder:\"Enter tax identification number\"})]});case 2:if(!isNewVendor)return null;return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsx(FormSelect,{label:\"Risk Level\",value:formData.security.riskLevel,onChange:value=>setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{security:_objectSpread(_objectSpread({},prev.security),{},{riskLevel:value})})),options:[{value:'low',label:'Low Risk'},{value:'medium',label:'Medium Risk'},{value:'high',label:'High Risk'}],placeholder:\"Select risk level\",required:true}),errors.riskLevel&&/*#__PURE__*/_jsx(\"p\",{className:\"text-red-500 text-sm\",children:errors.riskLevel}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:formData.security.complianceRequired,onChange:e=>setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{security:_objectSpread(_objectSpread({},prev.security),{},{complianceRequired:e.target.checked})})),className:\"mr-2\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm font-medium text-gray-700\",children:\"Compliance review required\"})]})}),/*#__PURE__*/_jsx(FormTextarea,{label:\"Security Notes\",value:formData.security.securityNotes,onChange:e=>setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{security:_objectSpread(_objectSpread({},prev.security),{},{securityNotes:e.target.value})})),placeholder:\"Any additional security considerations or notes\"})]});case 3:return/*#__PURE__*/_jsx(\"div\",{className:\"space-y-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-50 rounded-lg p-6\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-medium text-gray-800 mb-4\",children:\"Request Summary\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3 text-sm\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:\"Title:\"}),\" \",formData.title]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:\"Supplier:\"}),\" \",formData.supplier]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:\"Type:\"}),\" \",formData.purchaseType]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:\"Subsidiary:\"}),\" \",formData.subsidiary]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:\"Description:\"}),\" \",formData.description]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:\"Total Items:\"}),\" \",formData.lineItems.length]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:\"Total Amount:\"}),\" USD \",formData.lineItems.reduce((sum,item)=>sum+(parseFloat(item.amount)||0)*(parseInt(item.quantity)||1),0).toFixed(2)]})]})]})});default:return null;}};return/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-row min-h-screen\",children:[/*#__PURE__*/_jsx(Sidebar,{active:\"home\",onNavClick:key=>console.log('Nav:',key),logo:process.env.PUBLIC_URL+'/logo192.png',expanded:sidebarExpanded,setExpanded:setSidebarExpanded}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 flex flex-col min-h-screen \".concat(sidebarExpanded?'ml-48':'ml-16'),children:[\" \",/*#__PURE__*/_jsx(Header,{sectionTitle:\"Create purchase request\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-1 w-full pl-8 pr-8 py-10\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"w-64 pr-8\",children:[/*#__PURE__*/_jsx(BackLink,{onClick:handleBack,children:\"Back\"}),/*#__PURE__*/_jsx(Stepper,{steps:steps,onStepClick:setCurrentStep})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 flex flex-col\",children:[showAIFilling&&/*#__PURE__*/_jsx(\"div\",{className:\"mb-4\",children:/*#__PURE__*/_jsx(SystemMessage,{type:\"informative\",children:\"Tipalti AI is filling in your request\"})}),showAISuccess&&/*#__PURE__*/_jsx(\"div\",{className:\"mb-4\",children:/*#__PURE__*/_jsx(SystemMessage,{type:\"positive\",children:\"Purchase request was generated with AI, please review before submitting.\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-8\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-bold text-gray-800 mb-2\",children:(_steps$currentStep=steps[currentStep])===null||_steps$currentStep===void 0?void 0:_steps$currentStep.label}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-600\",children:[currentStep===0&&'Enter the basic details of your purchase request',currentStep===1&&'Provide information about the new supplier',currentStep===2&&'Complete security assessment for the new vendor',currentStep===3&&'Review your request before submission']})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg border border-gray-200 p-8\",children:[renderStepContent(),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between mt-8 pt-6 border-t border-gray-200\",children:[/*#__PURE__*/_jsx(Button,{variant:\"secondary\",onClick:handleSaveDraft,children:\"Save Draft\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-4\",children:[currentStep>0&&/*#__PURE__*/_jsx(Button,{variant:\"secondary\",onClick:handleBack,children:\"Back\"}),/*#__PURE__*/_jsx(Button,{variant:\"primary\",onClick:handleNext,children:currentStep===steps.length-1?'Submit Request':'Next'})]})]})]})]})]})]})]});}","map":{"version":3,"names":["React","useState","useEffect","Sidebar","Header","Button","BackLink","Stepper","FormInput","FormSelect","FormTextarea","LineItemsTable","Badge","SystemMessage","SUPPLIERS","PURCHASE_TYPES","SUBSIDIARIES","saveDraft","getDraft","generateDraftId","saveCurrentDraft","clearCurrentDraft","SAMPLE_HOME_REQUESTS","localDB","jsx","_jsx","jsxs","_jsxs","RequestForm","_ref","_steps$currentStep","onNavigate","draftId","aiData","sidebarExpanded","setSidebarExpanded","currentStep","setCurrentStep","formData","setFormData","id","title","supplier","purchaseType","subsidiary","description","lineItems","currency","amount","quantity","desc","supplierInfo","companyName","contactName","email","phone","address","taxId","security","riskLevel","complianceRequired","securityNotes","errors","setErrors","isNewVendor","setIsNewVendor","newVendorName","setNewVendorName","showAIFilling","setShowAIFilling","showAISuccess","setShowAISuccess","existingDraft","getById","amt","match","String","parseFloat","replace","_objectSpread","_existingDraft$suppli","_existingDraft$suppli2","vendor","prev","timer","setTimeout","clearTimeout","steps","label","active","completed","required","filter","step","validateCurrentStep","newErrors","trim","lineItemErrors","map","item","itemErrors","some","Object","keys","length","handleNext","handleSubmit","handleBack","handleSaveDraft","supplierObj","find","s","value","isNewVendorFlag","updatedDraft","update","status","updatedAt","Date","toISOString","handleSupplierChange","handleLineItemsChange","items","allVendorsSet","Set","r","getAll","allVendors","Array","from","Boolean","vendorOptions","push","sortedVendorOptions","slice","sort","a","b","localeCompare","renderStepContent","className","children","onChange","e","target","placeholder","found","opt","options","searchPlaceholder","action","onClick","onActionWithSearch","search","selectedDisplay","text","color","undefined","onItemChange","maxItems","type","checked","reduce","sum","parseInt","toFixed","onNavClick","key","console","log","logo","process","env","PUBLIC_URL","expanded","setExpanded","concat","sectionTitle","onStepClick","variant"],"sources":["C:/Users/yacov.gorovoy/Documents/Cursor-workspace/procurement-prototype/src/pages/RequestForm.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport Sidebar from '../components/Sidebar';\r\nimport Header from '../components/Header';\r\nimport Button from '../components/Button';\r\nimport BackLink from '../components/BackLink';\r\nimport Stepper from '../components/Stepper';\r\nimport FormInput from '../components/FormInput';\r\nimport FormSelect from '../components/FormSelect';\r\nimport FormTextarea from '../components/FormTextarea';\r\nimport LineItemsTable from '../components/LineItemsTable';\r\nimport Badge from '../components/Badge';\r\nimport SystemMessage from '../components/SystemMessage';\r\nimport { \r\n  SUPPLIERS, \r\n  PURCHASE_TYPES, \r\n  SUBSIDIARIES, \r\n  saveDraft, \r\n  getDraft, \r\n  generateDraftId,\r\n  saveCurrentDraft,\r\n  clearCurrentDraft,\r\n  SAMPLE_HOME_REQUESTS\r\n} from '../utils/mockData';\r\nimport { localDB } from '../utils/localDB';\r\n\r\nexport default function RequestForm({ onNavigate, draftId, aiData }) {\r\n  const [sidebarExpanded, setSidebarExpanded] = useState(true);\r\n  const [currentStep, setCurrentStep] = useState(0);\r\n  const [formData, setFormData] = useState({\r\n    id: draftId || generateDraftId(),\r\n    title: '',\r\n    supplier: '',\r\n    purchaseType: '',\r\n    subsidiary: '',\r\n    description: '',\r\n    lineItems: [{ currency: 'USD', amount: '', quantity: '1', desc: '' }],\r\n    supplierInfo: {\r\n      companyName: '',\r\n      contactName: '',\r\n      email: '',\r\n      phone: '',\r\n      address: '',\r\n      taxId: ''\r\n    },\r\n    security: {\r\n      riskLevel: '',\r\n      complianceRequired: false,\r\n      securityNotes: ''\r\n    }\r\n  });\r\n  const [errors, setErrors] = useState({});\r\n  const [isNewVendor, setIsNewVendor] = useState(false);\r\n  const [newVendorName, setNewVendorName] = useState('');\r\n  const [showAIFilling, setShowAIFilling] = useState(!!aiData);\r\n  const [showAISuccess, setShowAISuccess] = useState(false);\r\n\r\n  useEffect(() => {\r\n    // Load existing draft if draftId provided\r\n    if (draftId) {\r\n      const existingDraft = localDB.getById(draftId);\r\n      if (existingDraft) {\r\n        // Synthesize lineItems if missing\r\n        let lineItems = existingDraft.lineItems;\r\n        if (!lineItems) {\r\n          let amt = 0;\r\n          if (existingDraft.amount) {\r\n            const match = String(existingDraft.amount).match(/([\\d,.]+)/);\r\n            amt = match ? parseFloat(match[1].replace(/,/g, '')) : 0;\r\n          }\r\n          lineItems = [{ currency: 'USD', amount: amt, quantity: '1', desc: 'demo' }];\r\n        }\r\n        setFormData({ ...existingDraft, lineItems });\r\n        setIsNewVendor(existingDraft.supplier === 'new_vendor');\r\n        if (existingDraft.supplier === 'new_vendor') {\r\n          // Set newVendorName from vendor field if present\r\n          setNewVendorName(existingDraft.vendor || existingDraft.supplierInfo?.companyName || '');\r\n          // Ensure supplierInfo.companyName is set\r\n          if (!existingDraft.supplierInfo?.companyName && existingDraft.vendor) {\r\n            setFormData(prev => ({\r\n              ...prev,\r\n              supplierInfo: { ...prev.supplierInfo, companyName: existingDraft.vendor }\r\n            }));\r\n          }\r\n        }\r\n      }\r\n    }\r\n    \r\n    // Load AI data if provided\r\n    if (aiData) {\r\n      setFormData(prev => ({\r\n        ...prev,\r\n        title: aiData.title || '',\r\n        supplier: aiData.supplier || '',\r\n        purchaseType: aiData.purchaseType || '',\r\n        subsidiary: aiData.subsidiary || '',\r\n        description: aiData.description || '',\r\n        lineItems: aiData.lineItems || [{ currency: 'USD', amount: '', quantity: '1', desc: '' }]\r\n      }));\r\n      setIsNewVendor(aiData.supplier === 'new_vendor');\r\n    }\r\n  }, [draftId, aiData]);\r\n\r\n  useEffect(() => {\r\n    // Save current draft to session storage\r\n    saveCurrentDraft(formData);\r\n  }, [formData]);\r\n\r\n  useEffect(() => {\r\n    if (aiData) {\r\n      setShowAIFilling(true);\r\n      setShowAISuccess(false);\r\n      const timer = setTimeout(() => {\r\n        setShowAIFilling(false);\r\n        setShowAISuccess(true);\r\n      }, 2000);\r\n      return () => clearTimeout(timer);\r\n    } else {\r\n      setShowAIFilling(false);\r\n      setShowAISuccess(false);\r\n    }\r\n  }, [aiData]);\r\n\r\n  const steps = [\r\n    { label: 'Purchase details', active: currentStep === 0, completed: currentStep > 0 },\r\n    { label: 'Supplier info', active: currentStep === 1, completed: currentStep > 1, required: isNewVendor },\r\n    { label: 'Security', active: currentStep === 2, completed: currentStep > 2, required: isNewVendor },\r\n    { label: 'Review & Submit', active: currentStep === 3, completed: false }\r\n  ].filter(step => !step.required || step.required === isNewVendor);\r\n\r\n  const validateCurrentStep = () => {\r\n    const newErrors = {};\r\n    \r\n    if (currentStep === 0) {\r\n      if (!formData.title.trim()) newErrors.title = 'Title is required';\r\n      if (!formData.supplier) newErrors.supplier = 'Supplier is required';\r\n      if (!formData.purchaseType) newErrors.purchaseType = 'Purchase type is required';\r\n      if (!formData.subsidiary) newErrors.subsidiary = 'Subsidiary is required';\r\n      if (!formData.description.trim()) newErrors.description = 'Description is required';\r\n      \r\n      // Validate line items\r\n      const lineItemErrors = formData.lineItems.map(item => {\r\n        const itemErrors = {};\r\n        if (!item.amount || parseFloat(item.amount) <= 0) itemErrors.amount = 'Valid amount is required';\r\n        if (!item.desc.trim()) itemErrors.desc = 'Description is required';\r\n        return itemErrors;\r\n      });\r\n      if (lineItemErrors.some(errors => Object.keys(errors).length > 0)) {\r\n        newErrors.lineItems = lineItemErrors;\r\n      }\r\n    }\r\n    \r\n    if (currentStep === 1 && isNewVendor) {\r\n      if (!formData.supplierInfo.companyName.trim()) newErrors.companyName = 'Company name is required';\r\n      if (!formData.supplierInfo.contactName.trim()) newErrors.contactName = 'Contact name is required';\r\n      if (!formData.supplierInfo.email.trim()) newErrors.email = 'Email is required';\r\n    }\r\n    \r\n    if (currentStep === 2 && isNewVendor) {\r\n      if (!formData.security.riskLevel) newErrors.riskLevel = 'Risk level is required';\r\n    }\r\n    \r\n    setErrors(newErrors);\r\n    return Object.keys(newErrors).length === 0;\r\n  };\r\n\r\n  const handleNext = () => {\r\n    // Sync newVendorName to formData.supplierInfo.companyName if needed\r\n    if (formData.supplier === 'new_vendor' && newVendorName && !formData.supplierInfo.companyName) {\r\n      setFormData(prev => ({\r\n        ...prev,\r\n        supplierInfo: { ...prev.supplierInfo, companyName: newVendorName }\r\n      }));\r\n    }\r\n    if (validateCurrentStep()) {\r\n      if (currentStep < steps.length - 1) {\r\n        setCurrentStep(currentStep + 1);\r\n      } else {\r\n        handleSubmit();\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleBack = () => {\r\n    if (currentStep > 0) {\r\n      setCurrentStep(currentStep - 1);\r\n    } else {\r\n      onNavigate('home');\r\n    }\r\n  };\r\n\r\n  const handleSaveDraft = () => {\r\n    // Determine vendor name\r\n    let vendor = '';\r\n    if (formData.supplier === 'new_vendor') {\r\n      vendor = formData.supplierInfo.companyName || 'New Vendor';\r\n    } else {\r\n      const supplierObj = SUPPLIERS.find(s => s.value === formData.supplier);\r\n      vendor = supplierObj ? supplierObj.label : formData.supplier;\r\n    }\r\n    const isNewVendorFlag = formData.supplier === 'new_vendor';\r\n    // Save draft with vendor and isNewVendor fields\r\n    const updatedDraft = {\r\n      ...formData,\r\n      vendor,\r\n      isNewVendor: isNewVendorFlag,\r\n    };\r\n    // Update in localDB\r\n    localDB.update(formData.id, updatedDraft);\r\n    onNavigate('home');\r\n  };\r\n\r\n  const handleSubmit = () => {\r\n    if (validateCurrentStep()) {\r\n      // Save as submitted request (in real app, this would go to backend)\r\n      const updatedDraft = {\r\n        ...formData,\r\n        status: 'Pending approval',\r\n        updatedAt: new Date().toISOString(),\r\n      };\r\n      localDB.update(formData.id, updatedDraft);\r\n      onNavigate('home');\r\n    }\r\n  };\r\n\r\n  const handleSupplierChange = (value) => {\r\n    setFormData(prev => ({ ...prev, supplier: value }));\r\n    setIsNewVendor(value === 'new_vendor');\r\n    if (value !== 'new_vendor') setNewVendorName('');\r\n  };\r\n\r\n  const handleLineItemsChange = (items) => {\r\n    setFormData(prev => ({ ...prev, lineItems: items }));\r\n  };\r\n\r\n  // Merge all vendors from SUPPLIERS, SAMPLE_HOME_REQUESTS, and all requests in localDB\r\n  const allVendorsSet = new Set([\r\n    ...SUPPLIERS.map(s => s.label),\r\n    ...SAMPLE_HOME_REQUESTS.map(r => r.vendor),\r\n    ...localDB.getAll().map(r => r.vendor)\r\n  ]);\r\n  const allVendors = Array.from(allVendorsSet).filter(Boolean);\r\n  const vendorOptions = allVendors.map(vendor => {\r\n    const supplier = SUPPLIERS.find(s => s.label === vendor);\r\n    return supplier\r\n      ? { value: supplier.value, label: supplier.label }\r\n      : { value: vendor, label: vendor };\r\n  });\r\n  vendorOptions.push({ value: 'new_vendor', label: 'Add new vendor...' });\r\n  // Sort vendor options alphabetically (except 'Add new vendor...' stays last)\r\n  const sortedVendorOptions = vendorOptions.slice(0, -1).sort((a, b) => a.label.localeCompare(b.label));\r\n  sortedVendorOptions.push(vendorOptions[vendorOptions.length - 1]);\r\n\r\n  const renderStepContent = () => {\r\n    switch (currentStep) {\r\n      case 0:\r\n        return (\r\n          <div className=\"space-y-6\">\r\n            <FormInput\r\n              label=\"Request Title\"\r\n              value={formData.title}\r\n              onChange={(e) => setFormData(prev => ({ ...prev, title: e.target.value }))}\r\n              placeholder=\"e.g., Zoom Premium Licenses for Sales Team\"\r\n              required\r\n              className={errors.title ? 'border-red-500' : ''}\r\n            />\r\n            {errors.title && <p className=\"text-red-500 text-sm\">{errors.title}</p>}\r\n            \r\n            <FormSelect\r\n              label=\"Supplier\"\r\n              value={(() => {\r\n                // Try to match supplier value, otherwise match by vendor label\r\n                if (formData.supplier) return formData.supplier;\r\n                const found = sortedVendorOptions.find(opt => opt.label === formData.vendor);\r\n                return found ? found.value : '';\r\n              })()}\r\n              onChange={handleSupplierChange}\r\n              options={sortedVendorOptions}\r\n              placeholder=\"Select supplier\"\r\n              required\r\n              searchPlaceholder=\"Search suppliers...\"\r\n              action={{ label: 'Add new vendor', onClick: () => handleSupplierChange('new_vendor') }}\r\n              onActionWithSearch={\r\n                (search) => {\r\n                  setNewVendorName(search);\r\n                  setFormData(prev => ({ ...prev, supplier: 'new_vendor' }));\r\n                  setIsNewVendor(true);\r\n                }\r\n              }\r\n              selectedDisplay={\r\n                formData.supplier === 'new_vendor' && newVendorName\r\n                  ? <span className=\"flex items-center gap-2\">\r\n                      {newVendorName}\r\n                      <Badge text=\"New vendor\" color=\"bg-green-100 text-green-800\" />\r\n                    </span>\r\n                  : undefined\r\n              }\r\n            />\r\n            {errors.supplier && <p className=\"text-red-500 text-sm\">{errors.supplier}</p>}\r\n            \r\n            <FormSelect\r\n              label=\"Purchase Type\"\r\n              value={formData.purchaseType}\r\n              onChange={(value) => setFormData(prev => ({ ...prev, purchaseType: value }))}\r\n              options={[...PURCHASE_TYPES].sort((a, b) => a.label.localeCompare(b.label))}\r\n              placeholder=\"Select purchase type\"\r\n              required\r\n            />\r\n            {errors.purchaseType && <p className=\"text-red-500 text-sm\">{errors.purchaseType}</p>}\r\n            \r\n            <FormSelect\r\n              label=\"Subsidiary\"\r\n              value={formData.subsidiary}\r\n              onChange={(value) => setFormData(prev => ({ ...prev, subsidiary: value }))}\r\n              options={[...SUBSIDIARIES].sort((a, b) => a.label.localeCompare(b.label))}\r\n              placeholder=\"Select subsidiary\"\r\n              required\r\n            />\r\n            {errors.subsidiary && <p className=\"text-red-500 text-sm\">{errors.subsidiary}</p>}\r\n            \r\n            <FormTextarea\r\n              label=\"Description\"\r\n              value={formData.description}\r\n              onChange={(e) => setFormData(prev => ({ ...prev, description: e.target.value }))}\r\n              placeholder=\"Describe the purpose and details of this purchase request\"\r\n              required\r\n            />\r\n            {errors.description && <p className=\"text-red-500 text-sm\">{errors.description}</p>}\r\n            \r\n            <div>\r\n              <label className=\"block mb-2 font-medium text-gray-600\">Line Items</label>\r\n              <LineItemsTable\r\n                items={formData.lineItems}\r\n                onItemChange={handleLineItemsChange}\r\n                maxItems={20}\r\n              />\r\n            </div>\r\n          </div>\r\n        );\r\n        \r\n      case 1:\r\n        if (!isNewVendor) return null;\r\n        return (\r\n          <div className=\"space-y-6\">\r\n            <FormInput\r\n              label=\"Company Name\"\r\n              value={formData.supplierInfo.companyName}\r\n              onChange={(e) => setFormData(prev => ({ \r\n                ...prev, \r\n                supplierInfo: { ...prev.supplierInfo, companyName: e.target.value }\r\n              }))}\r\n              placeholder=\"Enter company name\"\r\n              required\r\n            />\r\n            {errors.companyName && <p className=\"text-red-500 text-sm\">{errors.companyName}</p>}\r\n            \r\n            <FormInput\r\n              label=\"Contact Name\"\r\n              value={formData.supplierInfo.contactName}\r\n              onChange={(e) => setFormData(prev => ({ \r\n                ...prev, \r\n                supplierInfo: { ...prev.supplierInfo, contactName: e.target.value }\r\n              }))}\r\n              placeholder=\"Enter contact person name\"\r\n              required\r\n            />\r\n            {errors.contactName && <p className=\"text-red-500 text-sm\">{errors.contactName}</p>}\r\n            \r\n            <FormInput\r\n              label=\"Email\"\r\n              type=\"email\"\r\n              value={formData.supplierInfo.email}\r\n              onChange={(e) => setFormData(prev => ({ \r\n                ...prev, \r\n                supplierInfo: { ...prev.supplierInfo, email: e.target.value }\r\n              }))}\r\n              placeholder=\"Enter contact email\"\r\n              required\r\n            />\r\n            {errors.email && <p className=\"text-red-500 text-sm\">{errors.email}</p>}\r\n            \r\n            <FormInput\r\n              label=\"Phone\"\r\n              value={formData.supplierInfo.phone}\r\n              onChange={(e) => setFormData(prev => ({ \r\n                ...prev, \r\n                supplierInfo: { ...prev.supplierInfo, phone: e.target.value }\r\n              }))}\r\n              placeholder=\"Enter contact phone\"\r\n            />\r\n            \r\n            <FormTextarea\r\n              label=\"Address\"\r\n              value={formData.supplierInfo.address}\r\n              onChange={(e) => setFormData(prev => ({ \r\n                ...prev, \r\n                supplierInfo: { ...prev.supplierInfo, address: e.target.value }\r\n              }))}\r\n              placeholder=\"Enter company address\"\r\n            />\r\n            \r\n            <FormInput\r\n              label=\"Tax ID\"\r\n              value={formData.supplierInfo.taxId}\r\n              onChange={(e) => setFormData(prev => ({ \r\n                ...prev, \r\n                supplierInfo: { ...prev.supplierInfo, taxId: e.target.value }\r\n              }))}\r\n              placeholder=\"Enter tax identification number\"\r\n            />\r\n          </div>\r\n        );\r\n        \r\n      case 2:\r\n        if (!isNewVendor) return null;\r\n        return (\r\n          <div className=\"space-y-6\">\r\n            <FormSelect\r\n              label=\"Risk Level\"\r\n              value={formData.security.riskLevel}\r\n              onChange={(value) => setFormData(prev => ({ \r\n                ...prev, \r\n                security: { ...prev.security, riskLevel: value }\r\n              }))}\r\n              options={[\r\n                { value: 'low', label: 'Low Risk' },\r\n                { value: 'medium', label: 'Medium Risk' },\r\n                { value: 'high', label: 'High Risk' }\r\n              ]}\r\n              placeholder=\"Select risk level\"\r\n              required\r\n            />\r\n            {errors.riskLevel && <p className=\"text-red-500 text-sm\">{errors.riskLevel}</p>}\r\n            \r\n            <div>\r\n              <label className=\"flex items-center\">\r\n                <input\r\n                  type=\"checkbox\"\r\n                  checked={formData.security.complianceRequired}\r\n                  onChange={(e) => setFormData(prev => ({ \r\n                    ...prev, \r\n                    security: { ...prev.security, complianceRequired: e.target.checked }\r\n                  }))}\r\n                  className=\"mr-2\"\r\n                />\r\n                <span className=\"text-sm font-medium text-gray-700\">Compliance review required</span>\r\n              </label>\r\n            </div>\r\n            \r\n            <FormTextarea\r\n              label=\"Security Notes\"\r\n              value={formData.security.securityNotes}\r\n              onChange={(e) => setFormData(prev => ({ \r\n                ...prev, \r\n                security: { ...prev.security, securityNotes: e.target.value }\r\n              }))}\r\n              placeholder=\"Any additional security considerations or notes\"\r\n            />\r\n          </div>\r\n        );\r\n        \r\n      case 3:\r\n        return (\r\n          <div className=\"space-y-6\">\r\n            <div className=\"bg-gray-50 rounded-lg p-6\">\r\n              <h3 className=\"font-medium text-gray-800 mb-4\">Request Summary</h3>\r\n              <div className=\"space-y-3 text-sm\">\r\n                <div><span className=\"font-medium\">Title:</span> {formData.title}</div>\r\n                <div><span className=\"font-medium\">Supplier:</span> {formData.supplier}</div>\r\n                <div><span className=\"font-medium\">Type:</span> {formData.purchaseType}</div>\r\n                <div><span className=\"font-medium\">Subsidiary:</span> {formData.subsidiary}</div>\r\n                <div><span className=\"font-medium\">Description:</span> {formData.description}</div>\r\n                <div><span className=\"font-medium\">Total Items:</span> {formData.lineItems.length}</div>\r\n                <div><span className=\"font-medium\">Total Amount:</span> USD {formData.lineItems.reduce((sum, item) => \r\n                  sum + (parseFloat(item.amount) || 0) * (parseInt(item.quantity) || 1), 0\r\n                ).toFixed(2)}</div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        );\r\n        \r\n      default:\r\n        return null;\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"flex flex-row min-h-screen\">\r\n      <Sidebar active=\"home\" onNavClick={key => console.log('Nav:', key)} logo={process.env.PUBLIC_URL + '/logo192.png'} expanded={sidebarExpanded} setExpanded={setSidebarExpanded} />\r\n      <div className={`flex-1 flex flex-col min-h-screen ${sidebarExpanded ? 'ml-48' : 'ml-16'}`}> {/* dynamic margin */}\r\n        {/* Header bar spanning full width */}\r\n        <Header sectionTitle=\"Create purchase request\" />\r\n        {/* Main content: Stepper left, form right */}\r\n        <div className=\"flex flex-1 w-full pl-8 pr-8 py-10\">\r\n          {/* Stepper on the left */}\r\n          <div className=\"w-64 pr-8\">\r\n            <BackLink onClick={handleBack}>Back</BackLink>\r\n            <Stepper steps={steps} onStepClick={setCurrentStep} />\r\n          </div>\r\n          {/* Form content on the right */}\r\n          <div className=\"flex-1 flex flex-col\">\r\n            {/* AI System Messages */}\r\n            {showAIFilling && (\r\n              <div className=\"mb-4\">\r\n                <SystemMessage type=\"informative\">\r\n                  Tipalti AI is filling in your request\r\n                </SystemMessage>\r\n              </div>\r\n            )}\r\n            {showAISuccess && (\r\n              <div className=\"mb-4\">\r\n                <SystemMessage type=\"positive\">\r\n                  Purchase request was generated with AI, please review before submitting.\r\n                </SystemMessage>\r\n              </div>\r\n            )}\r\n            <div className=\"mb-8\">\r\n              <h1 className=\"text-2xl font-bold text-gray-800 mb-2\">\r\n                {steps[currentStep]?.label}\r\n              </h1>\r\n              <p className=\"text-gray-600\">\r\n                {currentStep === 0 && 'Enter the basic details of your purchase request'}\r\n                {currentStep === 1 && 'Provide information about the new supplier'}\r\n                {currentStep === 2 && 'Complete security assessment for the new vendor'}\r\n                {currentStep === 3 && 'Review your request before submission'}\r\n              </p>\r\n            </div>\r\n            <div className=\"bg-white rounded-lg border border-gray-200 p-8\">\r\n              {renderStepContent()}\r\n              <div className=\"flex justify-between mt-8 pt-6 border-t border-gray-200\">\r\n                <Button variant=\"secondary\" onClick={handleSaveDraft}>\r\n                  Save Draft\r\n                </Button>\r\n                <div className=\"flex space-x-4\">\r\n                  {currentStep > 0 && (\r\n                    <Button variant=\"secondary\" onClick={handleBack}>\r\n                      Back\r\n                    </Button>\r\n                  )}\r\n                  <Button \r\n                    variant=\"primary\" \r\n                    onClick={handleNext}\r\n                  >\r\n                    {currentStep === steps.length - 1 ? 'Submit Request' : 'Next'}\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n} "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}